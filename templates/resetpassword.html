<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <title>Reset Password</title>
</head>

<body class="bg-light">
  <div class="container">
    <div class="row justify-content-center align-items-center min-vh-100">
      <div class="col-md-6 col-lg-5">
        <div class="card shadow-lg rounded-4">
          <div class="card-body p-4">
            <h3 class="text-center mb-3">Reset Password</h3>
            <p class="text-muted text-center mb-4">
              Enter your new password below and confirm it to reset your account password.
            </p>

            <!-- Reset Password Form -->
            <form id="resetPasswordForm" method="POST">
              {% csrf_token %}
              <!-- New Password -->
              <div class="mb-3">
                <label for="newPassword" class="form-label">New Password</label>
                <input type="password" class="form-control" id="newPassword" name="newPassword"
                  placeholder="Enter new password" required>
              </div>

              <!-- Confirm New Password -->
              <div class="mb-3">
                <label for="confirmPassword" class="form-label">Confirm Password</label>
                <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
                  placeholder="Confirm new password" required>
              </div>

              <!-- Reset Button -->
              <div class="d-grid">
                <button type="submit" class="btn btn-primary btn-lg" id="reset-btn">Reset Password</button>
              </div>
            </form>

            <!-- Back to Login -->
            <p class="text-center mt-3 mb-0">
              <a href="{% url 'login' %}">Back to Login</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- jQuery CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- jQuery + SweetAlert -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script>
    $(document).ready(function () {
      $('#resetPasswordForm').on('submit', function (e) {
        e.preventDefault();

        $.ajax({
          type: 'POST',
          url: "{% url 'resetpassword' %}",
          data: $(this).serialize(),
          success: function (response) {
            if (response.success) {
              Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: response.message
              }).then(() => {
                window.location.href = response.redirect_url;
              });
            } else {
              Swal.fire({
                icon: 'error',
                title: 'Error',
                text: response.message
              });
            }
          },
          error: function () {
            Swal.fire({
              icon: 'error',
              title: 'Error',
              text: 'Something went wrong!'
            });
          }
        });
      });
    });
  </script>
</body>

</html>